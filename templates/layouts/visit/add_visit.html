<ion-view title="{{(params.vid != '') ? 'Update':'Create'}} Visit">
   
<ion-content>
<form class="form-horizontal" >
	<div class="form-container fw">
        <div class="visitor3-page fw">
            <div class="white_box fw">
               <span><i class="ion-location"></i>Visit Form</span>
            </div>
        </div>
		<div class="container">
				<div class="row">
					<div class="col">
						
							<div class="form-group">
								<label class="control-label col-xs-5">Doc Series</label>
								<div class="col-xs-7"><input type="text" ng-readonly="true" ng-model="visitModel.DOC_SERIES" class="form-control" ></div>
							</div>
							<div class="form-group">
								<label class="control-label col-xs-5">Visit ID</label>
								<div class="col-xs-7"><input type="text" ng-readonly="true" ng-model="visitModel.VISIT_ID" class="form-control"></div>
							</div>
              <div class="form-group">
                <label class="control-label col-xs-5">Visit Details</label>
                <div class="col-xs-7"><input type="text" ng-model="visitModel.VISIT_DETAILS" maxlength="1000" class="form-control"></div>
              </div>
							<div class="form-group">
								<label class="control-label col-xs-5">Visit Time From</label>
								<div class="col-xs-7">
                                    <input type="text" placeholder="HH.mm" mask="23.59" maxlength="5" restrict="reject"  class="form-control" ng-model="visitModel.VISIT_TIME_FROM" class="form-control">
									</div>

							</div>
							<div class="form-group">
								<label class="control-label col-xs-5">Visit Time To</label>
								<div class="col-xs-7"><input type="text" placeholder="HH.mm" mask="23.59" maxlength="5" restrict="reject" class="form-control" ng-model="visitModel.VISIT_TIME_TO" class="form-control"></div>
							</div>
							<div class="form-group">
								<label class="control-label col-xs-5">Visit Date</label>
								<div class="col-xs-7"><input type="date" ng-model="visitModel.VISIT_DATE" data-date-enddate="2014-07-29" class="form-control"></div>
							</div>
							<div class="form-group" ng-class="{'erClass':eleId === 'CUSTOMER_NO'}" id="CUSTOMER_NO">
								<label class="control-label col-xs-5">Customer No*</label>
								<div class="col-xs-7">
                                <!-- <input type="text" ion-autocomplete type="text" readonly="readonly" class="ion-autocomplete form-control" autocomplete="off"
                       ng-model="visitModel.CUSTOMER_NO"
                       item-value-key="CUSTOMER_NO"
                       item-view-value-key="CUSTOMER_NO"
                       items-method="getCustom(query)"
                       items-method-value-key="Result"
                       max-selected-items="1"> -->

            <input ion-autocomplete type="text" readonly="readonly" class="ion-autocomplete form-control" autocomplete="off" ng-model="visitModel.CUSTOMER_NO"
                       item-value-key="CUSTOMER_NO"
                       item-view-value-key="label"
                       items-method="getCustomID(query)"
                       items-clicked-method="getCustomIDClicked(callback)"
                       items-removed-method="getCustomIDRemoved(callback)"
                       cancel-button-clicked-method="tesTing(callback)"
                       max-selected-items="1"
                       select-items-label="Search Customer No"
                       selected-items-label="Selected Customer No:"
                       component-id="CUSTOMER_NO" />


                                </div>
							</div>
							<div class="form-group" ng-class="{'erClass':eleId === 'CUSTOMER_NAME'}" id="CUSTOMER_NAME">
								<label class="control-label col-xs-5 no-pad-right">Customer Name*</label>
								<div class="col-xs-7">
                                <input ion-autocomplete type="text" readonly="readonly" class="ion-autocomplete form-control" autocomplete="off" ng-model="visitModel.CUSTOMER_NAME"
                                   item-value-key="CUSTOMER_NAME"
                                   item-view-value-key="label"
                                   items-method="getCustomNAME(query)"
                                   items-clicked-method="getCustomNAMEClicked(callback)"
                                   items-removed-method="getCustomNAMERemoved(callback)"
                                   cancel-button-clicked-method="tesTing(callback)"
                                   max-selected-items="1"
                                   select-items-label="Search Customer Name"
                                   selected-items-label="Selected Customer Name:"
                                   component-id="CUSTOMER_NAME" />

                                </div>
							</div>
							<div class="form-group" ng-class="{'erClass':eleId === 'AREA_NAME'}" id="AREA_NAME">
								<label class="control-label col-xs-5">Area Name*</label>
								<div class="col-xs-7">

                                <input type="text" ng-focus="rmEleId('AREA_NAME')" ng-show="showArea" ng-model="visitModel.AREA_NAME" class="form-control">

                                <select ng-focus="rmEleId('AREA_NAME')" class="form-control" ng-show="!showArea" ng-model="visitModel.AREA_NAME" ng-options="item.AreaName as item.AreaName for item in fillAreaArr" ng-change="getCustConatct()" ></select>

                                </div>
							</div>
							<div class="form-group" ng-class="{'erClass':eleId === 'ADDRESS'}" id="ADDRESS">
								<label class="control-label col-xs-5">Address*</label>
								<div class="col-xs-7">
                                <input ng-focus="rmEleId('ADDRESS')" type="text" ng-readonly="true" ng-click="getGeoLocation()" ng-model="visitModel.ADDRESS" class="form-control">

                                </div>
							</div>
							<div class="form-group">
								<label class="control-label col-xs-5">Remark</label>
								<div class="col-xs-7"><input type="text" ng-model="visitModel.REMARK" maxlength="255" class="form-control"></div>
							</div>
							
							
						
					</div>
				</div>
			</div>
		</div>
	</div>
    
	<div class="form-container fw">
        <div class="visitor3-page fw">
            <div class="white_box fw">
               <span><i class="ion-person"></i> Customer / Contact Form</span>
            </div>
        </div>
        <div class="container">
            <div class="row">
                <div class="col">
                  
                  <div class="contact-repeater" ng-repeat="list in visitModel.Contact">
                    <div ng-show="($index > 0)">
                       <hr>
                       <div class="form-group">
                            <div class="text-right">
                                <div class="padding plus-minus-btn" ng-click="visitModel.Contact.splice($index, 1)">
                                    <i class="ion-minus-circled"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                        <div class="form-group" ng-class="{'erClass':eleId === 'CUST_CONTACT_PERSON_'+$index}" id="CUST_CONTACT_PERSON_{{$index}}">
                            <label class="control-label col-xs-5">Person*</label>
                            <div class="col-xs-7">
                            <input ng-focus="rmEleId('CUST_CONTACT_PERSON_'+$index)"  type="text" class="form-control" ng-model="visitModel.Contact[$index]['CUST_CONTACT_PERSON']" maxlength="60" ng-show="showContact" >

                                <select ng-focus="rmEleId('CUST_CONTACT_PERSON_'+$index)" maxlength="60" class="form-control" ng-show="!showContact" ng-model="visitModel.Contact[$index]['CUST_CONTACT_PERSON']" ng-options="item.CONTACT_PERSON as item.CONTACT_PERSON for item in fillContactArr" ng-change="setVisitSelContact($index)"></select>
                            </div>
                        </div>
                        <div class="form-group" ng-class="{'erClass':eleId === 'CONTACT_POSITION_'+$index}" id="CONTACT_POSITION_{{$index}}">
                            <label class="control-label col-xs-5">Designation*</label>
                            <div class="col-xs-7"><input ng-focus="rmEleId('CONTACT_POSITION_'+$index)" type="text" class="form-control" maxlength="40" ng-model="visitModel.Contact[$index]['CONTACT_POSITION']"></div>
                        </div>
                        <div class="form-group" ng-class="{'erClass':eleId === 'MOBILE_NO_'+$index}" id="MOBILE_NO_{{$index}}">
                            <label class="control-label col-xs-5">Mobile No.*</label>
                            <div class="col-xs-7"><input ng-focus="rmEleId('MOBILE_NO_'+$index)" type="text" class="form-control" restrict-input="^[0-9]*$" maxlength="10" ng-model="visitModel.Contact[$index]['MOBILE_NO']"></div>
                        </div>
                        <div class="form-group" ng-class="{'erClass':eleId === 'EMAIL_'+$index}" id="EMAIL_{{$index}}">
                            <label class="control-label col-xs-5">Email</label>
                            <div class="col-xs-7"><input ng-focus="rmEleId('EMAIL_'+$index)" type="text" class="form-control" ng-model="visitModel.Contact[$index]['EMAIL']"></div>
                        </div>
                    </div>

                     <div class="form-group">
                        <div class="text-right">
                            <div class="padding plus-minus-btn" ng-click="visitModel.Contact.push({
                                'CUST_CONTACT_PERSON':'',
                                'CONTACT_POSITION':'',
                                'MOBILE_NO':'',
                                'EMAIL':'',
                               })">
                                <i class="ion-plus-circled"></i>
                            </div>
                        </div>
                    </div>

                    
                </div>
            </div>
        </div>
    </div>
    <div class="form-container fw">
        <div class="visitor3-page fw">
            <div class="white_box fw">
               <span><i class="ion-pricetags"></i> Sales Person Form</span>
               
            </div>
        </div>
        <div class="container">
            <div class="row">
                <div class="col">
                  
                <div class="sales-repeater" ng-repeat="list in visitModel.Sales">
                    <div ng-show="($index > 0)">
                       <hr>
                       <div class="form-group">
                            <div class="text-right">
                                <div class="padding plus-minus-btn" ng-click="visitModel.Sales.splice($index, 1)">
                                    <i class="ion-minus-circled"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group" ng-class="{'erClass':eleId === 'SALES_PERSON_NO_'+$index}" id="SALES_PERSON_NO_{{$index}}">
                            <label class="control-label col-xs-5 no-pad-right">Sales Person No*</label>
                            <div class="col-xs-7">
							<!-- <select class="form-control" ng-model="visitModel.Sales[$index]['SALES_PERSON_NO']"  ng-options="item.SALES_PERSON_NO as item.SALES_PERSON_NO for item in fillSalesArr" ng-change="setVisitSelSales($index)" ></select>	 -->

              <input ion-autocomplete type="text" readonly="readonly" class="ion-autocomplete form-control" autocomplete="off" ng-model="visitModel.Sales[$index]['SALES_PERSON_NO']"
                       item-value-key="SALES_PERSON_NO"
                       item-view-value-key="label"
                       items-method="getVisitSalesID(query,$index)"
                       items-clicked-method="getVisitSalesIDClicked(callback,$index)"
                       items-removed-method="getVisitSalesIDRemoved(callback,$index)"
                       max-selected-items="1"
                       select-items-label="Search Sales No"
                       selected-items-label="Selected Sales No:"
                       component-id="SALES_PERSON_NO_'+ $index +'" />


							</div>
                        </div>
                        <div class="form-group" ng-class="{'erClass':eleId === 'SALES_PERSON_NAME_'+$index}" id="SALES_PERSON_NAME_{{$index}}">
                            <label class="control-label col-xs-5">Name*</label>
                            <div class="col-xs-7"><input ng-focus="rmEleId('SALES_PERSON_NAME_'+$index)"  type="text" class="form-control" ng-model="visitModel.Sales[$index]['SALES_PERSON_NAME']"></div>
                        </div>
                        <div class="form-group">
                            <label class="control-label col-xs-5">Next Action</label>
                            <div class="col-xs-7"><input type="text" class="form-control" maxlength="80" ng-model="visitModel.Sales[$index]['NEXT_ACTION']"></div>
                        </div>
                        <div class="form-group" ng-class="{'erClass':eleId === 'NEXT_ACTION_DATE_'+$index}" id="NEXT_ACTION_DATE_{{$index}}">
                            <label class="control-label col-xs-5 no-pad-right">Next Action Date</label>
                            <div class="col-xs-7"><input ng-focus="rmEleId('NEXT_ACTION_DATE_'+$index)" type="date" class="form-control" ng-model="visitModel.Sales[$index]['NEXT_ACTION_DATE']"></div>
                        </div>
                        <div class="form-group" ng-class="{'erClass':eleId === 'NEXT_ACTION_TIME_'+$index}" id="NEXT_ACTION_TIME_{{$index}}">
                            <label class="control-label col-xs-5 no-pad-right">Next Action Time</label>
                            <div class="col-xs-7"><input ng-focus="rmEleId('NEXT_ACTION_TIME_'+$index)" type="text" class="form-control" ng-model="visitModel.Sales[$index]['NEXT_ACTION_TIME']" placeholder="HH.mm" mask="23.59" maxlength="5" restrict="reject"  ></div>
                        </div>
                        <div class="form-group">
                            <label class="control-label col-xs-5">Alert Required</label>
                            <div class="col-xs-7">
                                <select class="form-control" ng-model="visitModel.Sales[$index]['ALERT']">
                                    <option value=1 >Yes</option>
                                    <option value='N' ng-selected="true">No</option>
                                </select>
                            </div>
                        </div>
                        <div ng-show="(visitModel.Sales[$index]['ALERT'] == 1)">
                        <div class="form-group" ng-class="{'erClass':eleId === 'ALERT_DATE_'+$index}" id="ALERT_DATE_{{$index}}" >
                            <label class="control-label col-xs-5">Alert Date</label>
                            <div class="col-xs-7"><input ng-focus="rmEleId('ALERT_DATE_'+$index)" type="date" class="form-control" ng-model="visitModel.Sales[$index]['ALERT_DATE']"></div>
                        </div>
                        <div class="form-group" ng-class="{'erClass':eleId === 'ALERT_TIME_'+$index}" id="ALERT_TIME_{{$index}}">
                            <label class="control-label col-xs-5">Alert Time</label>
                            <div class="col-xs-7"><input ng-focus="rmEleId('ALERT_TIME_'+$index)" type="text" placeholder="HH.mm"  class="form-control" ng-model="visitModel.Sales[$index]['ALERT_TIME']" mask="23.59" maxlength="5"></div>
                        </div>
                        </div>

                    </div>

                        <div class="form-group">
                            <div class="text-right">
                                <div class="padding plus-minus-btn" ng-click="visitModel.Sales.push({
                                'SALES_PERSON_NO':'',
                                'SALES_PERSON_NAME':'',
                                'NEXT_ACTION':'',
                                'NEXT_ACTION_DATE':'',
                                'NEXT_ACTION_TIME':'',
                                'ALERT':'N',
                                'ALERT_DATE':'',
                                'ALERT_TIME':''
                               })">
                                    <i class="ion-plus-circled"></i>
                                </div>
                            </div>
                        </div>
               
             </div>
         </div>
    
</div>

 <div style="display:flex;" ng-show="((params.vid == ''))" class="row">
    <div class="col-100 col"><button type="button" class="button button-block button-small button-assertive" ng-click="SaveVisit('Add')">Save</button></div>
  </div>

  <div style="display:flex;" ng-show="((params.vid != ''))" class="row">
      <div class="col col-50"><button type="button" class="button button-block button-small button-assertive" ng-click="SaveVisit('Authorize')">Authorize</button></div>
    <div  class="col col-50"><button  type="button" ng-click="SaveVisit('Update')"  class="button button-block button-small button-assertive" >Update</button></div>
  </div>





</form>



</ion-content>
</ion-view>
